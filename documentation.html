

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; datasketch 1.6.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2ad11211"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HyperLogLog" href="hyperloglog.html" />
    <link rel="prev" title="datasketch: Big Data Looks Small" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            datasketch
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#minhash">MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHash"><code class="docutils literal notranslate"><span class="pre">MinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__init__"><code class="docutils literal notranslate"><span class="pre">MinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.update"><code class="docutils literal notranslate"><span class="pre">MinHash.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.update_batch"><code class="docutils literal notranslate"><span class="pre">MinHash.update_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.jaccard"><code class="docutils literal notranslate"><span class="pre">MinHash.jaccard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.count"><code class="docutils literal notranslate"><span class="pre">MinHash.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.merge"><code class="docutils literal notranslate"><span class="pre">MinHash.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.digest"><code class="docutils literal notranslate"><span class="pre">MinHash.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHash.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.clear"><code class="docutils literal notranslate"><span class="pre">MinHash.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.copy"><code class="docutils literal notranslate"><span class="pre">MinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__len__"><code class="docutils literal notranslate"><span class="pre">MinHash.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__eq__"><code class="docutils literal notranslate"><span class="pre">MinHash.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.union"><code class="docutils literal notranslate"><span class="pre">MinHash.union()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHash.__weakref__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.bulk"><code class="docutils literal notranslate"><span class="pre">MinHash.bulk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.generator"><code class="docutils literal notranslate"><span class="pre">MinHash.generator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lean-minhash">Lean MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.LeanMinHash"><code class="docutils literal notranslate"><span class="pre">LeanMinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__init__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.update"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.copy"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.bytesize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.bytesize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.serialize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.serialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.deserialize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.deserialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__getstate__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__getstate__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__hash__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__hash__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.union"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.union()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#weighted-minhash">Weighted MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.__init__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.minhash"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.minhash()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.minhash_many"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.minhash_many()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.__weakref__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.__weakref__</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.WeightedMinHash"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__init__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.jaccard"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.jaccard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.digest"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.copy"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__len__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__eq__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__weakref__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh">MinHash LSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSH"><code class="docutils literal notranslate"><span class="pre">MinHashLSH</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.insert"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.merge"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.insertion_session"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.insertion_session()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.add_to_query_buffer"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.add_to_query_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.collect_query_buffer"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.collect_query_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.remove"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.remove()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.get_counts"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.get_counts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.get_subset_counts"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.get_subset_counts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asynchronous-minhash-lsh">Asynchronous MinHash LSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh-forest">MinHash LSH Forest</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSHForest"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.add"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.index"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.get_minhash_hashvalues"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.get_minhash_hashvalues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh-ensemble">MinHash LSH Ensemble</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.index"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hyperloglog">HyperLogLog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.HyperLogLog"><code class="docutils literal notranslate"><span class="pre">HyperLogLog</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__init__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.update"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.count"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.merge"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.digest"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.copy"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.is_empty"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.clear"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__len__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__eq__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.bytesize"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.bytesize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__getstate__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__getstate__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">HyperLogLog++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.__init__"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.__weakref__"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.__weakref__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.count"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.count()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hnsw">HNSW</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.HNSW"><code class="docutils literal notranslate"><span class="pre">HNSW</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__init__"><code class="docutils literal notranslate"><span class="pre">HNSW.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__len__"><code class="docutils literal notranslate"><span class="pre">HNSW.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__contains__"><code class="docutils literal notranslate"><span class="pre">HNSW.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__getitem__"><code class="docutils literal notranslate"><span class="pre">HNSW.__getitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__setitem__"><code class="docutils literal notranslate"><span class="pre">HNSW.__setitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__delitem__"><code class="docutils literal notranslate"><span class="pre">HNSW.__delitem__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__iter__"><code class="docutils literal notranslate"><span class="pre">HNSW.__iter__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.reversed"><code class="docutils literal notranslate"><span class="pre">HNSW.reversed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__eq__"><code class="docutils literal notranslate"><span class="pre">HNSW.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.get"><code class="docutils literal notranslate"><span class="pre">HNSW.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.items"><code class="docutils literal notranslate"><span class="pre">HNSW.items()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.keys"><code class="docutils literal notranslate"><span class="pre">HNSW.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.values"><code class="docutils literal notranslate"><span class="pre">HNSW.values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.pop"><code class="docutils literal notranslate"><span class="pre">HNSW.pop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.popitem"><code class="docutils literal notranslate"><span class="pre">HNSW.popitem()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.clear"><code class="docutils literal notranslate"><span class="pre">HNSW.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.copy"><code class="docutils literal notranslate"><span class="pre">HNSW.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.update"><code class="docutils literal notranslate"><span class="pre">HNSW.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.setdefault"><code class="docutils literal notranslate"><span class="pre">HNSW.setdefault()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.insert"><code class="docutils literal notranslate"><span class="pre">HNSW.insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.query"><code class="docutils literal notranslate"><span class="pre">HNSW.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.remove"><code class="docutils literal notranslate"><span class="pre">HNSW.remove()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.clean"><code class="docutils literal notranslate"><span class="pre">HNSW.clean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.merge"><code class="docutils literal notranslate"><span class="pre">HNSW.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HNSW.__weakref__"><code class="docutils literal notranslate"><span class="pre">HNSW.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hyperloglog.html">HyperLogLog</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperloglog.html#hyperloglog-plusplus">HyperLogLog++</a></li>
<li class="toctree-l1"><a class="reference internal" href="lsh.html">MinHash LSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="lshensemble.html">MinHash LSH Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="lshforest.html">MinHash LSH Forest</a></li>
<li class="toctree-l1"><a class="reference internal" href="minhash.html">MinHash</a></li>
<li class="toctree-l1"><a class="reference internal" href="weightedminhash.html">Weighted MinHash</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">datasketch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/documentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Link to this heading"></a></h1>
<section id="minhash">
<h2>MinHash<a class="headerlink" href="#minhash" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHash">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues:</span> <span class="pre">~typing.Iterable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutations:</span> <span class="pre">~typing.Tuple[~typing.Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Iterable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash" title="Link to this definition"></a></dt>
<dd><p>MinHash is a probabilistic data structure for computing
<a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> between sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_perm</strong> (<em>int</em>) – Number of random permutation functions.
It will be ignored if <cite>hashvalues</cite> is not None.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – The random seed controls the set of random
permutation functions generated for this MinHash.</p></li>
<li><p><strong>hashfunc</strong> (<em>Callable</em>) – The hash function used by
this MinHash.
It takes the input passed to the <a class="reference internal" href="#datasketch.MinHash.update" title="datasketch.MinHash.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> method and
returns an integer that can be encoded with 32 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.
Users can use <cite>farmhash</cite> for better performance.
See the example in <a class="reference internal" href="#datasketch.MinHash.update" title="datasketch.MinHash.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
<li><p><strong>hashvalues</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>]</em>) – The hash values is
the internal state of the MinHash. It can be specified for faster
initialization using the existing <code class="xref py py-attr docutils literal notranslate"><span class="pre">hashvalues</span></code> of another MinHash.</p></li>
<li><p><strong>permutations</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>Iterable</em><em>, </em><em>Iterable</em><em>]</em><em>]</em>) – The permutation
function parameters as a tuple of two lists. This argument
can be specified for faster initialization using the existing
<code class="xref py py-attr docutils literal notranslate"><span class="pre">permutations</span></code> from another MinHash.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To save memory usage, consider using <a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.LeanMinHash</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 1.1.1, MinHash will only support serialization using
<a class="reference external" href="https://docs.python.org/3/library/pickle.html">pickle</a>. <code class="docutils literal notranslate"><span class="pre">serialize</span></code> and <code class="docutils literal notranslate"><span class="pre">deserialize</span></code> methods are removed,
and are supported in <a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.LeanMinHash</span></code></a> instead.
MinHash serialized before version 1.1.1 cannot be deserialized properly
in newer versions (<a class="reference external" href="https://github.com/ekzhu/datasketch/issues/18">need to migrate?</a>).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 1.1.3, MinHash uses Numpy’s random number generator
instead of Python’s built-in random package. This change makes the
hash values consistent across different Python versions.
The side-effect is that now MinHash created before version 1.1.3 won’t
work (i.e., <a class="reference internal" href="#datasketch.MinHash.jaccard" title="datasketch.MinHash.jaccard"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jaccard()</span></code></a>, <a class="reference internal" href="#datasketch.MinHash.merge" title="datasketch.MinHash.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">merge()</span></code></a> and <a class="reference internal" href="#datasketch.MinHash.union" title="datasketch.MinHash.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>)
with those created after.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues:</span> <span class="pre">~typing.Iterable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutations:</span> <span class="pre">~typing.Tuple[~typing.Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Iterable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.update" title="Link to this definition"></a></dt>
<dd><p>Update this MinHash with a new value.
The value will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> – The value to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with a new string value (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">Minhash</span><span class="p">()</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also use a different hash function, for example, <cite>pyfarmhash</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">farmhash</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_hash_32</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">farmhash</span><span class="o">.</span><span class="n">hash32</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">hashfunc</span><span class="o">=</span><span class="n">_hash_32</span><span class="p">)</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.update_batch">
<span class="sig-name descname"><span class="pre">update_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.update_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.update_batch" title="Link to this definition"></a></dt>
<dd><p>Update this MinHash with new values.
The values will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> (<em>Iterable</em>) – Values to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with new string values (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">Minhash</span><span class="p">()</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update_batch</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;token1&quot;</span><span class="p">,</span> <span class="s2">&quot;token2&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.jaccard">
<span class="sig-name descname"><span class="pre">jaccard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.jaccard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.jaccard" title="Link to this definition"></a></dt>
<dd><p>Estimate the <a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> (resemblance) between the sets
represented by this MinHash and the other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The other MinHash.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Jaccard similarity, which is between 0.0 and 1.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the two MinHashes have different numbers of
    permutation functions or different seeds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.count" title="Link to this definition"></a></dt>
<dd><p>Estimate the cardinality count based on the technique described in
<a class="reference external" href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=365694">this paper</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The estimated cardinality of the set represented by this MinHash.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.merge" title="Link to this definition"></a></dt>
<dd><p>Merge the other MinHash with this one, making this one the union
of both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The other MinHash.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the two MinHashes have different numbers of
    permutation functions or different seeds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.digest" title="Link to this definition"></a></dt>
<dd><p>Export the hash values, which is the internal state of the
MinHash.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The hash values which is a Numpy array.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.is_empty" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>If the current MinHash is empty - at the state of just</dt><dd><p>initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.clear" title="Link to this definition"></a></dt>
<dd><p>Clear the current state of the MinHash.
All hash values are reset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.copy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a copy of this MinHash by exporting its state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">MinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__len__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of hash values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__eq__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If their seeds and hash values are both equal then two are equivalent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.union">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.union" title="Link to this definition"></a></dt>
<dd><p>Create a MinHash which is the union of the MinHash objects passed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*mhs</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash objects to be united. The argument list length is variable,
but must be at least 2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new union MinHash.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">MinHash</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the number of MinHash objects passed as arguments is less than 2,
    or if the MinHash objects passed as arguments have different seeds or
    different numbers of permutation functions.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinHash</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">m1</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">update_batch</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="n">m2</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">update_batch</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Union m1 and m2.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHash.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHash.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.bulk">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bulk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">minhash_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.bulk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.bulk" title="Link to this definition"></a></dt>
<dd><p>Compute MinHashes in bulk. This method avoids unnecessary
overhead when initializing many minhashes by reusing the initialized
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>Iterable</em>) – An Iterable of lists of bytes, each list is
hashed in to one MinHash in the output.</p></li>
<li><p><strong>**minhash_kwargs</strong> – Keyword arguments used to initialize MinHash,
will be used for all minhashes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of computed MinHashes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">datasketch.MinHash</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinHash</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="sa">b</span><span class="s1">&#39;token1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token3&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;token4&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token6&#39;</span><span class="p">]]</span>
<span class="n">minhashes</span> <span class="o">=</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">bulk</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.generator">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">minhash_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.generator" title="Link to this definition"></a></dt>
<dd><p>Compute MinHashes in a generator. This method avoids unnecessary
overhead when initializing many minhashes by reusing the initialized
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>Iterable</em>) – An Iterable of lists of bytes, each list is
hashed in to one MinHash in the output.</p></li>
<li><p><strong>minhash_kwargs</strong> – Keyword arguments used to initialize MinHash,
will be used for all minhashes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a generator of computed MinHashes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generator[<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">MinHash</a>, None, None]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinHash</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="sa">b</span><span class="s1">&#39;token1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token3&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;token4&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token6&#39;</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">minhash</span> <span class="ow">in</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">generator</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
    <span class="c1"># do something useful</span>
    <span class="n">minhash</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="lean-minhash">
<h2>Lean MinHash<a class="headerlink" href="#lean-minhash" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.LeanMinHash">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">LeanMinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash" title="Link to this definition"></a></dt>
<dd><p>Lean MinHash is MinHash with a smaller memory footprint
and faster deserialization, but with its internal state frozen
– no <cite>update()</cite>.</p>
<p>Lean MinHash inherits all methods from <a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHash</span></code></a>.
It does not store the <cite>permutations</cite> and the <cite>hashfunc</cite> needed for updating.
If a MinHash does not need further updates, convert it into a lean MinHash
to save memory.</p>
<p class="rubric">Example</p>
<p>To create a lean MinHash from an existing MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="p">(</span><span class="n">minhash</span><span class="p">)</span>

<span class="c1"># You can compute the Jaccard similarity between two lean MinHash</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">lean_minhash2</span><span class="p">)</span>

<span class="c1"># Or between a lean MinHash and a MinHash</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">minhash2</span><span class="p">)</span>
</pre></div>
</div>
<p>To create a lean MinHash from the hash values and seed of an existing
MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                           <span class="n">hashvalues</span><span class="o">=</span><span class="n">minhash</span><span class="o">.</span><span class="n">hashvalues</span><span class="p">)</span>
</pre></div>
</div>
<p>To create a MinHash from a lean MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                  <span class="n">hashvalues</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">hashvalues</span><span class="p">)</span>

<span class="c1"># Or if you want to prevent further updates on minhash</span>
<span class="c1"># from affecting the state of lean_minhash</span>
<span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                  <span class="n">hashvalues</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lean MinHash can also be used in <a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.MinHashLSH"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSH</span></code></a>,
<a class="reference internal" href="#datasketch.MinHashLSHForest" title="datasketch.MinHashLSHForest"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSHForest</span></code></a>, and <a class="reference internal" href="#datasketch.MinHashLSHEnsemble" title="datasketch.MinHashLSHEnsemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSHEnsemble</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<em>optional</em>) – The <a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHash</span></code></a> object used to
initialize the LeanMinHash. If this is not set, then <cite>seed</cite>
and <cite>hashvalues</cite> must be set.</p></li>
<li><p><strong>seed</strong> (<em>optional</em>) – The random seed that controls the set of random
permutation functions generated for this LeanMinHash. This parameter
must be used together with <cite>hashvalues</cite>.</p></li>
<li><p><strong>hashvalues</strong> (<em>optional</em>) – The hash values used to inititialize the state
of the LeanMinHash. This parameter must be used together with
<cite>seed</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.update" title="Link to this definition"></a></dt>
<dd><p>This method is not available on a LeanMinHash.
Calling it raises a TypeError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.lean_minhash.LeanMinHash"><span class="pre">LeanMinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.copy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a copy of this MinHash by exporting its state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">MinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.bytesize">
<span class="sig-name descname"><span class="pre">bytesize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.bytesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.bytesize" title="Link to this definition"></a></dt>
<dd><p>Compute the byte size after serialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>byteorder</strong> (<em>str</em><em>, </em><em>optional</em>) – This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Size in number of bytes after serialization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.serialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.serialize" title="Link to this definition"></a></dt>
<dd><p>Serialize this lean MinHash and store the result in an allocated buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<em>buffer</em>) – <cite>buf</cite> must implement the <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">buffer</a> interface.
One such example is the built-in <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> class.</p></li>
<li><p><strong>byteorder</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</p></li>
</ul>
</dd>
</dl>
<p>This is preferred over using <a class="reference external" href="https://docs.python.org/3/library/pickle.html">pickle</a> if the serialized lean MinHash needs
to be used by another program in a different programming language.</p>
<dl class="simple">
<dt>The serialization schema:</dt><dd><ol class="arabic simple">
<li><p>The first 8 bytes is the seed integer</p></li>
<li><p>The next 4 bytes is the number of hash values</p></li>
<li><p>The rest is the serialized hash values, each uses 4 bytes</p></li>
</ol>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To serialize a single lean MinHash into a <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">bytesize</span><span class="p">())</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</pre></div>
</div>
<p>To serialize multiple lean MinHash into a <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># assuming lean_minhashs is a list of LeanMinHash with the same size</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">lean_minhashs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bytesize</span><span class="p">()</span>
<span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">lean_minhashs</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lean_minhash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lean_minhashs</span><span class="p">):</span>
    <span class="n">lean_minhash</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">size</span><span class="p">:])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.deserialize">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.lean_minhash.LeanMinHash"><span class="pre">LeanMinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.deserialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.deserialize" title="Link to this definition"></a></dt>
<dd><p>Deserialize a lean MinHash from a buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<em>buffer</em>) – <cite>buf</cite> must implement the <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">buffer</a> interface.
One such example is the built-in <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> class.</p></li>
<li><p><strong>byteorder</strong> (<em>str. optional</em>) – <p>This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deserialized lean MinHash</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash">datasketch.LeanMinHash</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To deserialize a lean MinHash from a buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__getstate__">
<span class="sig-name descname"><span class="pre">__getstate__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__getstate__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__getstate__" title="Link to this definition"></a></dt>
<dd><p>Helper for pickle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__hash__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__hash__" title="Link to this definition"></a></dt>
<dd><p>Return hash(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.union">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">lmhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.lean_minhash.LeanMinHash"><span class="pre">LeanMinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.lean_minhash.LeanMinHash"><span class="pre">LeanMinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.union" title="Link to this definition"></a></dt>
<dd><p>Create a new lean MinHash by unioning multiple lean MinHash.</p>
</dd></dl>

</dd></dl>

</section>
<section id="weighted-minhash">
<h2>Weighted MinHash<a class="headerlink" href="#weighted-minhash" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">WeightedMinHashGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator" title="Link to this definition"></a></dt>
<dd><p>The weighted MinHash generator is used for creating
new <a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedMinHash</span></code></a> objects.</p>
<p>This weighted MinHash implementation is based on Sergey Ioffe’s paper,
<a class="reference external" href="http://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36928.pdf">Improved Consistent Sampling, Weighted Minhash and L1 Sketching</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – The number of dimensions of the input Jaccard vectors.</p></li>
<li><p><strong>sample_size</strong> (<em>int</em>) – The number of samples to use for creating
weighted MinHash.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – The random seed to use for generating permutation functions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.minhash">
<span class="sig-name descname"><span class="pre">minhash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.minhash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.minhash" title="Link to this definition"></a></dt>
<dd><p>Create a new weighted MinHash given a weighted Jaccard vector.
Each dimension is an integer
frequency of the corresponding element in the multi-set represented
by the vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<em>numpy.ndarray</em>) – The Jaccard vector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The weighted MinHash.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash">WeightedMinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.minhash_many">
<span class="sig-name descname"><span class="pre">minhash_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">spmatrix</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.minhash_many"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.minhash_many" title="Link to this definition"></a></dt>
<dd><p>Create new WeightedMinHash instances given a matrix of weighted
Jaccard vectors. In the input matrix X, each row corresponds to a
multi-set, and each column stores the integer frequency of the
element of a dimension.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is experimental and does not yield the same MinHash
hash values as <a class="reference internal" href="#datasketch.WeightedMinHashGenerator.minhash" title="datasketch.WeightedMinHashGenerator.minhash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">minhash()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>Union</em><em>[</em><em>scipy.sparse.spmatrix</em><em>, </em><em>numpy.ndarray</em><em>]</em>) – A matrix of Jaccard
vectors (rows).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Union[WeightedMinHash, None]] - A list of length X.shape[0].
Each element is either a <a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedMinHash</span></code></a> instance or None
(if the original row in X is empty).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">WeightedMinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash" title="Link to this definition"></a></dt>
<dd><p>New weighted MinHash is generated by
<a class="reference internal" href="#datasketch.WeightedMinHashGenerator" title="datasketch.WeightedMinHashGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightedMinHashGenerator</span></code></a>.
You can also initialize a weighted MinHash by using the state
from an existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – The random seed used to generate this weighted
MinHash.</p></li>
<li><p><strong>hashvalues</strong> (<em>numpy.ndarray</em>) – The internal state of this weighted MinHash.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.jaccard">
<span class="sig-name descname"><span class="pre">jaccard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.jaccard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.jaccard" title="Link to this definition"></a></dt>
<dd><p>Estimate the <a class="reference external" href="http://mathoverflow.net/questions/123339/weighted-jaccard-similarity">weighted Jaccard similarity</a> between the
multi-sets represented by this weighted MinHash and the other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><em>WeightedMinHash</em></a>) – The other weighted MinHash.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The weighted Jaccard similarity between 0.0 and 1.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the two weighted MinHash objects have different
    seeds or different numbers of hash values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.digest" title="Link to this definition"></a></dt>
<dd><p>Export the hash values, which is the internal state of the
weighted MinHash.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The hash values which is a Numpy array.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.copy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of this weighted MinHash by exporting
its state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash">WeightedMinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__len__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of hash values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__eq__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If their seeds and hash values are both equal then two
are equivalent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.WeightedMinHash.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

</section>
<section id="minhash-lsh">
<h2>MinHash LSH<a class="headerlink" href="#minhash-lsh" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSH">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH" title="Link to this definition"></a></dt>
<dd><p>The <a class="reference internal" href="lsh.html#minhash-lsh"><span class="std std-ref">MinHash LSH</span></a> index.
It supports query with <a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> threshold.
Reference: <a class="reference external" href="http://www.mmds.org/">Chapter 3, Mining of Massive Datasets</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>float</em>) – The Jaccard similarity threshold between 0.0 and
1.0. The initialized MinHash LSH will be optimized for the threshold by
minizing the false positive and false negative.</p></li>
<li><p><strong>num_perm</strong> (<em>int</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>weights</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Used to adjust the relative importance of
minimizing false positive and false negative when optimizing
for the Jaccard similarity threshold.
<cite>weights</cite> is a tuple in the format of
<code class="code docutils literal notranslate"><span class="pre">(false_positive_weight,</span> <span class="pre">false_negative_weight)</span></code>.</p></li>
<li><p><strong>params</strong> (<em>Optiona</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The LSH parameters (i.e., number of bands and size
of each bands). This is used to bypass the parameter optimization
step in the constructor. <cite>threshold</cite> and <cite>weights</cite> will be ignored
if this is given.</p></li>
<li><p><strong>storage_config</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>]</em>) – Type of storage service to use for storing
hashtables and keys.
<cite>basename</cite> is an optional property whose value will be used as the prefix to
stored keys. If this is not set, a random string will be generated instead. If you
set this, you will be responsible for ensuring there are no key collisions.</p></li>
<li><p><strong>prepickle</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – If True, all keys are pickled to bytes before
insertion. If not specified, a default value is chosen based on the
<cite>storage_config</cite>.</p></li>
<li><p><strong>hashfunc</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>bytes</em><em>]</em><em>, </em><em>bytes</em><em>]</em><em>]</em>) – If a hash function is provided it will be used to
compress the index keys to reduce the memory footprint. This could cause a higher
false positive rate.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>weights</cite> must sum to 1.0, and the format is
(false positive weight, false negative weight).
For example, if minimizing false negative (or maintaining high recall) is more
important, assign more weight toward false negative: weights=(0.4, 0.6).
Try to live with a small difference between weights (i.e. &lt; 0.5).</p>
</div>
<p class="rubric">Examples</p>
<p>Create an index with 128 permutation functions optimized for Jaccard
threshold 0.9:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lsh</span> <span class="o">=</span> <span class="n">MinHashLSH</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lsh</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">lsh</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="c1"># 5 25</span>
</pre></div>
</div>
<p>The built-in optimizer will try to minimize the weighted sum of
probabilities of false positive and false negative. The algorithm is
a simple grid search over the space of possible parameters.</p>
<p>Note that it is possible to get <code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code> (number of bands) and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">r</span></code> (band size) that do not sum to <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_perm</span></code>, leading to
unused permutation values in the indexed MinHash.
This is because the optimizer only considers bands of
the same size, and the number of bands is not necessarily a divisor of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">num_perm</span></code>.</p>
<p>Instead of using the built-in optimizer, you can customize the LSH
parameters your self. The snippet below creates an index with 128
permutation functions and 16 bands each with size 8, skipping the
optimization step:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lsh</span> <span class="o">=</span> <span class="n">MinHashLSH</span><span class="p">(</span><span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lsh</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">lsh</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
<span class="c1"># 16 8</span>
</pre></div>
</div>
<p>Create an index backed by Redis storage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lsh</span> <span class="o">=</span> <span class="n">MinHashLSH</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">storage_config</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;redis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;basename&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;mylsh&#39;</span><span class="p">,</span> <span class="c1"># optional, defaults to a random string.</span>
    <span class="s1">&#39;redis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">6379</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <cite>basename</cite> property is optional. It is used to generate key prefixes
in the storage layer to uniquely identify data associated with this LSH.
Thus, if you create a new LSH object with the same <cite>basename</cite>, you will
be using the same underlying data in the storage layer associated with
a previous LSH object. If you do not set this property, a random string
will be generated instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_duplication</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.insert" title="Link to this definition"></a></dt>
<dd><p>Insert a key to the index, together with a MinHash or Weighted MinHash
of the set referenced by the key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>Hashable</em>) – The unique identifier of the set.</p></li>
<li><p><strong>minhash</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a><em>, </em><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><em>WeightedMinHash</em></a><em>]</em>) – The MinHash of the set.</p></li>
<li><p><strong>check_duplication</strong> (<em>bool</em>) – To avoid duplicate keys in the storage
(<cite>default=True</cite>). It’s recommended to not change the default, but
if you want to avoid the overhead during insert you can set
<cite>check_duplication = False</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.lsh.MinHashLSH"><span class="pre">MinHashLSH</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.merge" title="Link to this definition"></a></dt>
<dd><p>Merge the other MinHashLSH with this one, making this one the union
of both.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only num_perm, number of bands and sizes of each band is checked for equivalency of two MinHashLSH indexes.
Other initialization parameters threshold, weights, storage_config, prepickle and hash_func are not checked.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.MinHashLSH"><em>MinHashLSH</em></a>) – The other MinHashLSH.</p></li>
<li><p><strong>check_overlap</strong> (<em>bool</em>) – Check if there are any overlapping keys before merging and raise if there are any.
(<cite>default=False</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the two MinHashLSH have different initialization
    parameters, or if <cite>check_overlap</cite> is <cite>True</cite> and there are overlapping keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.insertion_session">
<span class="sig-name descname"><span class="pre">insertion_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MinHashLSHInsertionSession</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.insertion_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.insertion_session" title="Link to this definition"></a></dt>
<dd><p>Create a context manager for fast insertion into this index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer_size</strong> (<em>int</em>) – The buffer size for insert_session mode (default=50000).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The context manager.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MinHashLSHInsertionSession</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Insert 100 MinHashes into an Redis-backed index using a session:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinHash</span><span class="p">,</span> <span class="n">MinHashLSH</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">minhashes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">update_batch</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">minhashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">lsh</span> <span class="o">=</span> <span class="n">MinHashLSH</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">storage_config</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;redis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;redis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">6379</span><span class="p">},</span>
<span class="p">})</span>
<span class="k">with</span> <span class="n">lsh</span><span class="o">.</span><span class="n">insertion_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">minhashes</span><span class="p">):</span>
        <span class="n">session</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.query" title="Link to this definition"></a></dt>
<dd><p>Giving the MinHash of the query set, retrieve
the keys that reference sets with Jaccard
similarities likely greater than the threshold.</p>
<p>Results are based on minhash segment collision
and are thus approximate. For more accurate results,
filter again with <a class="reference internal" href="#datasketch.MinHash.jaccard" title="datasketch.MinHash.jaccard"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MinHash.jaccard()</span></code></a>. For exact results,
filter by computing Jaccard similarity using original sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash of the query set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of unique keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Query and rank results using <a class="reference internal" href="#datasketch.MinHash.jaccard" title="datasketch.MinHash.jaccard"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MinHash.jaccard()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinHash</span><span class="p">,</span> <span class="n">MinHashLSH</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Generate 100 random MinHashes.</span>
<span class="n">minhashes</span> <span class="o">=</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">bulk</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
    <span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span>
<span class="p">)</span>

<span class="c1"># Create LSH index.</span>
<span class="n">lsh</span> <span class="o">=</span> <span class="n">MinHashLSH</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">minhashes</span><span class="p">):</span>
    <span class="n">lsh</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="c1"># Get the initial results from LSH.</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">minhashes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lsh</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># Rank results using Jaccard similarity estimated by MinHash.</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[(</span><span class="n">query</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">minhashes</span><span class="p">[</span><span class="n">key</span><span class="p">]),</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.421875</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.4140625</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.359375</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.3359375</span><span class="p">,</span> <span class="mi">78</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.265625</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2578125</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">98</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.171875</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
</pre></div>
</div>
<p>Note that although the threshold is set to 0.5, the results are not
guaranteed to be above 0.5 because the LSH index is approximate and
the Jaccard similarity is estimated by MinHash.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.add_to_query_buffer">
<span class="sig-name descname"><span class="pre">add_to_query_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.add_to_query_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.add_to_query_buffer" title="Link to this definition"></a></dt>
<dd><p>Giving the MinHash of the query set, buffer
queries to retrieve the keys that references
sets with Jaccard similarities greater than
the threshold.</p>
<p>Buffered queries can be executed using
<a class="reference internal" href="#datasketch.MinHashLSH.collect_query_buffer" title="datasketch.MinHashLSH.collect_query_buffer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">collect_query_buffer()</span></code></a>. The combination of these
functions is way faster if cassandra backend
is used with <cite>shared_buffer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash of the query set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.collect_query_buffer">
<span class="sig-name descname"><span class="pre">collect_query_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.collect_query_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.collect_query_buffer" title="Link to this definition"></a></dt>
<dd><p>Execute and return buffered queries given
by <a class="reference internal" href="#datasketch.MinHashLSH.add_to_query_buffer" title="datasketch.MinHashLSH.add_to_query_buffer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_to_query_buffer()</span></code></a>.</p>
<p>If multiple query MinHash were added to the query buffer,
the intersection of the results of all query MinHash will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of unique keys.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.__contains__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>Hashable</em>) – The unique identifier of a set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True only if the key exists in the index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.remove" title="Link to this definition"></a></dt>
<dd><p>Remove the key from the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>Hashable</em>) – The unique identifier of a set.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the key does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.is_empty" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>True</cite> only if the index is empty.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.get_counts">
<span class="sig-name descname"><span class="pre">get_counts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.get_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.get_counts" title="Link to this definition"></a></dt>
<dd><p>Returns a list of length <code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code> (i.e., number of hash tables) with
each element a dictionary mapping hash table bucket key to the number
of indexed keys stored under each bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of dictionaries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.get_subset_counts">
<span class="sig-name descname"><span class="pre">get_subset_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.get_subset_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.get_subset_counts" title="Link to this definition"></a></dt>
<dd><p>Returns the bucket allocation counts (see <a class="reference internal" href="#datasketch.MinHashLSH.get_counts" title="datasketch.MinHashLSH.get_counts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_counts()</span></code></a> above)
restricted to the list of keys given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>Hashable</em>) – the keys for which to get the bucket allocation
counts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of dictionaries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSH.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

</section>
<section id="asynchronous-minhash-lsh">
<h2>Asynchronous MinHash LSH<a class="headerlink" href="#asynchronous-minhash-lsh" title="Link to this heading"></a></h2>
</section>
<section id="minhash-lsh-forest">
<h2>MinHash LSH Forest<a class="headerlink" href="#minhash-lsh-forest" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSHForest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest" title="Link to this definition"></a></dt>
<dd><p>The LSH Forest for MinHash. It supports top-k query in Jaccard
similarity.
Instead of using prefix trees as the <a class="reference external" href="http://ilpubs.stanford.edu:8090/678/1/2005-14.pdf">original paper</a>,
I use a sorted array to store the hash values in every
hash table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_perm</strong> (<em>int</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>l</strong> (<em>int</em>) – The number of prefix trees as described in the
paper.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MinHash LSH Forest also works with weighted Jaccard similarity
and weighted MinHash without modification.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.add" title="Link to this definition"></a></dt>
<dd><p>Add a unique key, together
with a MinHash (or weighted MinHash) of the set referenced by the key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The key won’t be searchbale until the
<a class="reference internal" href="#datasketch.MinHashLSHForest.index" title="datasketch.MinHashLSHForest.index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">index()</span></code></a> method is called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>Hashable</em>) – The unique identifier of the set.</p></li>
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash of the set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.index" title="Link to this definition"></a></dt>
<dd><p>Index all the keys added so far and make them searchable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.query" title="Link to this definition"></a></dt>
<dd><p>Return the approximate top-k keys that have the
(approximately) highest Jaccard similarities to the query set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash of the query set.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The maximum number of keys to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of at most k keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Hashable]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tip for improving accuracy:
you can use a multiple of <cite>k</cite> (e.g., <cite>2*k</cite>) in the argument,
compute the exact (or approximate using MinHash) Jaccard
similarities of the sets referenced by the returned keys,
from which you then take the final top-k. This is often called
“post-processing”. Because the total number of similarity
computations is still bounded by a constant multiple of <cite>k</cite>, the
performance won’t degrade too much – however you do have to keep
the original sets (or MinHashes) around some where so that you
can make references to them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.get_minhash_hashvalues">
<span class="sig-name descname"><span class="pre">get_minhash_hashvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.get_minhash_hashvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.get_minhash_hashvalues" title="Link to this definition"></a></dt>
<dd><p>Returns the hashvalues from the MinHash object that corresponds to the given key in the LSHForest,
if it exists. This is useful for when we want to reconstruct the original MinHash
object to manually check the Jaccard Similarity for the top-k results from a query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>Hashable</em>) – The key whose MinHash hashvalues we want to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The hashvalues for the MinHash object corresponding to the given key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hashvalues</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.is_empty" title="Link to this definition"></a></dt>
<dd><p>Check whether there is any searchable keys in the index.
Note that keys won’t be searchable until <cite>index</cite> is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if there is no searchable key in the index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.__contains__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True only if the key has been added to the index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSHForest.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

</section>
<section id="minhash-lsh-ensemble">
<h2>MinHash LSH Ensemble<a class="headerlink" href="#minhash-lsh-ensemble" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSHEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_part</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble" title="Link to this definition"></a></dt>
<dd><p>The <a class="reference internal" href="lshensemble.html#minhash-lsh-ensemble"><span class="std std-ref">MinHash LSH Ensemble</span></a> index. It supports
<a class="reference internal" href="lshensemble.html#containment"><span class="std std-ref">Containment</span></a> queries.
The implementation is based on
<a class="reference external" href="http://www.vldb.org/pvldb/vol9/p1185-zhu.pdf">E. Zhu et al.</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>float</em>) – The Containment threshold between 0.0 and
1.0. The initialized LSH Ensemble will be optimized for the threshold by
minizing the false positive and false negative.</p></li>
<li><p><strong>num_perm</strong> (<em>int</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>num_part</strong> (<em>int</em>) – The number of partitions in LSH Ensemble.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The memory usage factor: an LSH Ensemble uses approximately
<cite>m</cite> times more memory space than a MinHash LSH with the same number of
sets indexed. The higher the <cite>m</cite> the better the accuracy.</p></li>
<li><p><strong>weights</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Used to adjust the relative importance of
minizing false positive and false negative when optimizing
for the Containment threshold. Similar to the <cite>weights</cite> parameter
in <a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.MinHashLSH"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSH</span></code></a>.</p></li>
<li><p><strong>storage_config</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>]</em>) – Type of storage service to use for storing
hashtables and keys.
<cite>basename</cite> is an optional property whose value will be used as the prefix to
stored keys. If this is not set, a random string will be generated instead. If you
set this, you will be responsible for ensuring there are no key collisions.</p></li>
<li><p><strong>prepickle</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – If True, all keys are pickled to bytes before
insertion. If None, a default value is chosen based on the
<cite>storage_config</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using more partitions (<cite>num_part</cite>) leads to better accuracy, at the
expense of slower query performance.
This is different from <a class="reference external" href="http://www.vldb.org/pvldb/vol9/p1185-zhu.pdf">the paper</a> and the <a class="reference external" href="https://github.com/ekzhu/lshensemble">Go implementation</a>, in which
more partitions leads to better accuracy AND faster query performance,
due to parallelism.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>More information about the parameter <cite>m</cite> can be found in the
<a class="reference external" href="https://github.com/ekzhu/lshensemble">Go implementation</a>
of LSH Ensemble, in which <cite>m</cite> is named <cite>MaxK</cite>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_part</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.index" title="Link to this definition"></a></dt>
<dd><p>Index all sets given their keys, MinHashes, and sizes.
It can be called only once after the index is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>entries</strong> (<em>Iterable</em><em>[</em><em>Tuple</em><em>[</em><em>Hashable</em><em>, </em><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a><em>, </em><em>int</em><em>]</em><em>]</em>) – An iterable of
tuples, each must be in the form of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">minhash,</span> <span class="pre">size)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">key</span></code> is the unique
identifier of a set, <code class="docutils literal notranslate"><span class="pre">minhash</span></code> is the MinHash of the set,
and <code class="docutils literal notranslate"><span class="pre">size</span></code> is the size or number of unique items in the set.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the index is not empty or <code class="docutils literal notranslate"><span class="pre">entries</span></code> is empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.MinHash" title="datasketch.minhash.MinHash"><span class="pre">MinHash</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.query" title="Link to this definition"></a></dt>
<dd><p>Giving the MinHash and size of the query set, retrieve
keys that references sets with containment with respect to
the query set greater than the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>MinHash</em></a>) – The MinHash of the query set.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – The size (number of unique items) of the query set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an iterator of keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generator[Hashable, None, None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__contains__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>hashable</em>) – The unique identifier of a set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True only if the key exists in the index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.is_empty" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Check if the index is empty.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

</section>
<section id="hyperloglog">
<h2>HyperLogLog<a class="headerlink" href="#hyperloglog" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.HyperLogLog">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">HyperLogLog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog" title="Link to this definition"></a></dt>
<dd><p>The HyperLogLog data sketch for estimating
cardinality of very large dataset in a single pass.
The original HyperLogLog is described <a class="reference external" href="http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf">here</a>.</p>
<p>This HyperLogLog implementation is based on:
<a class="reference external" href="https://github.com/svpcom/hyperloglog">https://github.com/svpcom/hyperloglog</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>int</em>) – The precision parameter. It is ignored if
the <cite>reg</cite> is given.</p></li>
<li><p><strong>reg</strong> (<em>Optional</em><em>[</em><em>numpy.ndarray</em><em>]</em>) – The internal state.
This argument is for initializing the HyperLogLog from
an existing one.</p></li>
<li><p><strong>hashfunc</strong> (<em>Callable</em>) – The hash function used by this MinHash.
It takes the input passed to the <cite>update</cite> method and
returns an integer that can be encoded with 32 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.update" title="Link to this definition"></a></dt>
<dd><p>Update the HyperLogLog with a new data value in bytes.
The value will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> – The value to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with a new string value (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hll</span> <span class="o">=</span> <span class="n">HyperLogLog</span><span class="p">()</span>
<span class="n">hll</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also use a different hash function, for example, <cite>pyfarmhash</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">farmhash</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_hash_32</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">farmhash</span><span class="o">.</span><span class="n">hash32</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">hll</span> <span class="o">=</span> <span class="n">HyperLogLog</span><span class="p">(</span><span class="n">hashfunc</span><span class="o">=</span><span class="n">_hash_32</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.count" title="Link to this definition"></a></dt>
<dd><p>Estimate the cardinality of the data values seen so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The estimated cardinality.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.hyperloglog.HyperLogLog"><span class="pre">HyperLogLog</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.merge" title="Link to this definition"></a></dt>
<dd><p>Merge the other HyperLogLog with this one, making this the union of the
two.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog"><em>HyperLogLog</em></a>) – The other HyperLogLog to be merged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.digest" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current internal state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.hyperloglog.HyperLogLog"><span class="pre">HyperLogLog</span></a></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.copy" title="Link to this definition"></a></dt>
<dd><p>Create a copy of the current HyperLogLog by exporting its state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the current HyperLogLog.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog">HyperLogLog</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.is_empty" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current HyperLogLog is empty - at the state of just
initialized.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.clear" title="Link to this definition"></a></dt>
<dd><p>Reset the current HyperLogLog to empty.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__len__" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Get the size of the HyperLogLog as the size of</dt><dd><p><cite>reg</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.hyperloglog.HyperLogLog"><span class="pre">HyperLogLog</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__eq__" title="Link to this definition"></a></dt>
<dd><p>Check equivalence between two HyperLogLogs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog"><em>HyperLogLog</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if both have the same internal state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.bytesize">
<span class="sig-name descname"><span class="pre">bytesize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.bytesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.bytesize" title="Link to this definition"></a></dt>
<dd><p>Get the size of the HyperLogLog in bytes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__getstate__">
<span class="sig-name descname"><span class="pre">__getstate__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__getstate__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__getstate__" title="Link to this definition"></a></dt>
<dd><p>Helper for pickle.</p>
</dd></dl>

</dd></dl>

</section>
<section id="id3">
<h2>HyperLogLog++<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">HyperLogLogPlusPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash64&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus" title="Link to this definition"></a></dt>
<dd><p>HyperLogLog++ is an enhanced HyperLogLog <a class="reference external" href="http://research.google.com/pubs/pub40671.html">from Google</a>.
Main changes from the original HyperLogLog:</p>
<ol class="arabic simple">
<li><p>Use 64 bits instead of 32 bits for hash function</p></li>
<li><p>A new small-cardinality estimation scheme</p></li>
<li><p>Sparse representation (not implemented here)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>int</em>) – The precision parameter. It is ignored if
the <cite>reg</cite> is given.</p></li>
<li><p><strong>reg</strong> (<em>Optional</em><em>[</em><em>numpy.array</em><em>]</em>) – The internal state.
This argument is for initializing the HyperLogLog from
an existing one.</p></li>
<li><p><strong>hashfunc</strong> (<em>Callable</em>) – The hash function used by this MinHash.
It takes the input passed to the <cite>update</cite> method and
returns an integer that can be encoded with 64 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">sha1_hash64&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj:</span> <span class="pre">object</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.count" title="Link to this definition"></a></dt>
<dd><p>Estimate the cardinality of the data values seen so far.</p>
</dd></dl>

</dd></dl>

</section>
<section id="hnsw">
<h2>HNSW<a class="headerlink" href="#hnsw" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.HNSW">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">HNSW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef_construction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reversed_edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW" title="Link to this definition"></a></dt>
<dd><p>Hierarchical Navigable Small World (HNSW) graph index for approximate
nearest neighbor search. This implementation is based on the paper
“Efficient and robust approximate nearest neighbor search using Hierarchical
Navigable Small World graphs” by Yu. A. Malkov, D. A. Yashunin (2016),
<a class="reference external" href="https://arxiv.org/abs/1603.09320">https://arxiv.org/abs/1603.09320</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance_func</strong> – A function that takes two vectors and returns a float
representing the distance between them.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The number of neighbors to keep for each node.</p></li>
<li><p><strong>ef_construction</strong> (<em>int</em>) – The number of neighbors to consider during
construction.</p></li>
<li><p><strong>m0</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to keep for each node at
the 0th level. If None, defaults to 2 * m.</p></li>
<li><p><strong>seed</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The random seed to use for the random number
generator.</p></li>
<li><p><strong>reverse_edges</strong> (<em>bool</em>) – Whether to maintain reverse edges in the graph.
This speeds up hard remove (<a class="reference internal" href="#datasketch.HNSW.remove" title="datasketch.HNSW.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a>) but increases memory
usage and slows down <a class="reference internal" href="#datasketch.HNSW.insert" title="datasketch.HNSW.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an HNSW index with Euclidean distance and insert 1000 random
vectors of dimension 10.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">index</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="c1"># Query the index for the 10 nearest neighbors of the first vector.</span>
<span class="n">index</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an HNSW index with Jaccard distance and insert 1000 random
sets of 10 elements each.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Each set is represented as a 10-element vector of random integers</span>
<span class="c1"># between 0 and 100.</span>
<span class="c1"># Deduplication is handled by the distance function.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">jaccard_distance</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span>
    <span class="mf">1.0</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
    <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
<span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="n">jaccard_distance</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>

<span class="c1"># Query the index for the 10 nearest neighbors of the first set.</span>
<span class="n">index</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef_construction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reversed_edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__len__" title="Link to this definition"></a></dt>
<dd><p>Return the number of points in the index excluding those
that were soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__contains__" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the index contains the key and it was
not soft-removed, else <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Get the point associated with the key. Raises KeyError if the key
does not exist in the index or it was soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__setitem__" title="Link to this definition"></a></dt>
<dd><p>Set the point associated with the key and update the index.
This is equivalent to calling <a class="reference internal" href="#datasketch.HNSW.insert" title="datasketch.HNSW.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a> with the key and point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__delitem__">
<span class="sig-name descname"><span class="pre">__delitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__delitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__delitem__" title="Link to this definition"></a></dt>
<dd><p>Soft remove the point associated with the key. Raises a KeyError if the
key does not exist in the index. This is equivalent to calling
<a class="reference internal" href="#datasketch.HNSW.remove" title="datasketch.HNSW.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a> with the key.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__iter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__iter__" title="Link to this definition"></a></dt>
<dd><p>Return an iterator over the keys of the index that were not
soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.reversed">
<span class="sig-name descname"><span class="pre">reversed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.reversed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.reversed" title="Link to this definition"></a></dt>
<dd><p>Return a reverse iterator over the keys of the index that were not
soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_HNSW__value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.__eq__" title="Link to this definition"></a></dt>
<dd><p>Return True only if the index parameters, random states, keys, points
points, and index structures are equal, including deleted points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.get" title="Link to this definition"></a></dt>
<dd><p>Return the point for key in the index, else default. If default is not
given and key is not in the index or it was soft-removed, return None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.items" title="Link to this definition"></a></dt>
<dd><p>Return an iterator of the indexed points that were not soft-removed
as (key, point) pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.keys" title="Link to this definition"></a></dt>
<dd><p>Return an iterator of the keys of the index points that were not
soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.values" title="Link to this definition"></a></dt>
<dd><p>Return an iterator of the index points that were not soft-removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.pop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.pop" title="Link to this definition"></a></dt>
<dd><p>If key is in the index, remove it and return its associated point,
else return default. If default is not given and key is not in the index
or it was soft-removed, raise KeyError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.popitem">
<span class="sig-name descname"><span class="pre">popitem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.popitem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.popitem" title="Link to this definition"></a></dt>
<dd><p>Remove and return a (key, point) pair from the index. Pairs are
returned in LIFO order if <cite>last</cite> is true or FIFO order if false.
If the index is empty or all points are soft-removed, raise KeyError.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In versions of Python before 3.7, the order of items in the index
is not guaranteed. This method will remove and return an arbitrary
(key, point) pair.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.clear" title="Link to this definition"></a></dt>
<dd><p>Clear the index of all data points. This will not reset the random
number generator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.HNSW" title="datasketch.hnsw.HNSW"><span class="pre">HNSW</span></a></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.copy" title="Link to this definition"></a></dt>
<dd><p>Create a copy of the index. The copy will have the same parameters
as the original index and the same keys and points, but will not share
any index data structures (i.e., graphs) with the original index.
The new index’s random state will start from a copy of the original
index’s.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#datasketch.HNSW" title="datasketch.hnsw.HNSW"><span class="pre">HNSW</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.update" title="Link to this definition"></a></dt>
<dd><p>Update the index with the points from the other Mapping or HNSW object,
overwriting existing keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Union</em><em>[</em><em>Mapping</em><em>, </em><a class="reference internal" href="#datasketch.HNSW" title="datasketch.HNSW"><em>HNSW</em></a><em>]</em>) – The other Mapping or HNSW object.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an HNSW index with a dictionary of points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>

<span class="c1"># Batch insert 1000 points.</span>
<span class="n">index</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)})</span>
</pre></div>
</div>
<p>Create an HNSW index with another HNSW index.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">index1</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
<span class="n">index2</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>

<span class="c1"># Batch insert 1000 points.</span>
<span class="n">index1</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)})</span>

<span class="c1"># Update index2 with the points from index1.</span>
<span class="n">index2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.setdefault">
<span class="sig-name descname"><span class="pre">setdefault</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.setdefault"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.setdefault" title="Link to this definition"></a></dt>
<dd><p>If key is in the index and it was not soft-removed, return
its associated point. If not, insert
key with a value of default and return default. default cannot be None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.insert" title="Link to this definition"></a></dt>
<dd><p>Add a new point to the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>Hashable</em>) – The key of the new point. If the key already exists in the
index, the point will be updated and the index will be repaired.</p></li>
<li><p><strong>new_point</strong> (<em>np.ndarray</em>) – The new point to add to the index.</p></li>
<li><p><strong>ef</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to consider during insertion.
If None, use the construction ef.</p></li>
<li><p><strong>level</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The level at which to insert the new point.
If None, the level will be chosen automatically.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.query" title="Link to this definition"></a></dt>
<dd><p>Search for the k nearest neighbors of the query point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_point</strong> (<em>np.ndarray</em>) – The query point.</p></li>
<li><p><strong>k</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to return. If None, return
all neighbors found.</p></li>
<li><p><strong>ef</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to consider during search.
If None, use the construction ef.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of (key, distance) pairs for the k</dt><dd><p>nearest neighbors of the query point.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[Hashable, float]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the entry point is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.remove" title="Link to this definition"></a></dt>
<dd><p>Remove a point from the index. This removal algorithm is based on
the discussion on <a class="reference external" href="https://github.com/nmslib/hnswlib/issues/4">hnswlib issue #4</a>. There are two versions:</p>
<ul class="simple">
<li><p><em>soft remove</em>: the point is marked as removed from the index, but its
data and out-going edges are kept. Future queries will not return
the point and no new edge will direct to this point,
but the point will still be used for graph traversal.
This is the default behavior.</p></li>
<li><p><em>hard remove</em>: the point is removed from the index and its data and
out-going edges are also removed. Points with out-going edges pointing
to the deleted point will have their out-going edges
re-assigned using the same pruning algorithm as <a class="reference internal" href="#datasketch.HNSW.insert" title="datasketch.HNSW.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a> during
point update.</p></li>
</ul>
<p>In both versions, if the deleted point is the current entry point,
the entry point will be re-assigned to the next point in the highest
layer that has other points beside the current entry point.</p>
<p>Subsequent soft removes without a hard remove of the same point will
not affect the index, <strong>unless the point was the only point in the index
as removing it clears the index</strong>. This is different from <a class="reference internal" href="#datasketch.HNSW.pop" title="datasketch.HNSW.pop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pop()</span></code></a>
which will always raise a KeyError if the key was removed.</p>
<p>Subsequent hard removes of the same point will
raise a KeyError. If the point is soft removed and then hard removed,
the point will be removed from the index.
Use <a class="reference internal" href="#datasketch.HNSW.clean" title="datasketch.HNSW.clean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clean()</span></code></a> for removing all soft removed points from the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>Hashable</em>) – The key of the point to remove.</p></li>
<li><p><strong>hard</strong> (<em>bool</em>) – If True, perform a hard remove. Otherwise, perform a
soft remove.</p></li>
<li><p><strong>ef</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to consider during
re-assignment. If None, use the construction ef. This argument
is only used when hard is True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the index is empty or the key does not exist in the
    index and was not soft removed.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
<span class="n">index</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">)})</span>

<span class="c1"># Soft remove a point with key = 0.</span>
<span class="n">index</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Soft remove the same point again will not change the index</span>
<span class="c1"># because the index is not empty.</span>
<span class="n">index</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="n">index</span><span class="p">)</span>  <span class="c1"># False</span>

<span class="c1"># Hard remove the point.</span>
<span class="n">index</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hard</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Hard remove the same point again will raise a KeyError.</span>
<span class="c1"># index.remove(0, hard=True)</span>

<span class="c1"># Soft remove rest of the points from the index.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="n">index</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>  <span class="c1"># 0</span>

<span class="c1"># Clean the index to hard remove all soft removed points.</span>
<span class="n">index</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.clean" title="Link to this definition"></a></dt>
<dd><p>Remove all soft removed points from the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ef</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of neighbors to consider during
re-assignment. If None, use the construction ef.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HNSW.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#datasketch.HNSW" title="datasketch.hnsw.HNSW"><span class="pre">HNSW</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datasketch.HNSW" title="datasketch.hnsw.HNSW"><span class="pre">HNSW</span></a></span></span><a class="reference internal" href="_modules/datasketch/hnsw.html#HNSW.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HNSW.merge" title="Link to this definition"></a></dt>
<dd><p>Create a new index by merging the current index with another index.
The new index will contain all points from both indexes.
If a point exists in both, the point from the other index will be used.
The new index will have the same parameters as the current index and
a copy of the current index’s random state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.HNSW" title="datasketch.HNSW"><em>HNSW</em></a>) – The other index to merge with.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new index containing all points from both indexes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.HNSW" title="datasketch.HNSW">HNSW</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasketch.hnsw</span><span class="w"> </span><span class="kn">import</span> <span class="n">HNSW</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">index1</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
<span class="n">index2</span> <span class="o">=</span> <span class="n">HNSW</span><span class="p">(</span><span class="n">distance_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>

<span class="c1"># Batch insert data into the indexes.</span>
<span class="n">index1</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data1</span><span class="p">)})</span>
<span class="n">index2</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data1</span><span class="p">):</span> <span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data2</span><span class="p">)})</span>

<span class="c1"># Merge the indexes.</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">index1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">index2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.HNSW.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.HNSW.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="datasketch: Big Data Looks Small" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hyperloglog.html" class="btn btn-neutral float-right" title="HyperLogLog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Eric Zhu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-93507731-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-93507731-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>