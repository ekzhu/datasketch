
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API Documentation &#8212; datasketch 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HyperLogLog" href="hyperloglog.html" />
    <link rel="prev" title="datasketch: Big Data Looks Small" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">datasketch</a></h1>



<p class="blurb">Probabilistic data structures for Big Data</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ekzhu&repo=datasketch&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#minhash">MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHash"><code class="docutils literal notranslate"><span class="pre">MinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__init__"><code class="docutils literal notranslate"><span class="pre">MinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.update"><code class="docutils literal notranslate"><span class="pre">MinHash.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.update_batch"><code class="docutils literal notranslate"><span class="pre">MinHash.update_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.jaccard"><code class="docutils literal notranslate"><span class="pre">MinHash.jaccard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.count"><code class="docutils literal notranslate"><span class="pre">MinHash.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.merge"><code class="docutils literal notranslate"><span class="pre">MinHash.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.digest"><code class="docutils literal notranslate"><span class="pre">MinHash.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHash.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.clear"><code class="docutils literal notranslate"><span class="pre">MinHash.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.copy"><code class="docutils literal notranslate"><span class="pre">MinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__len__"><code class="docutils literal notranslate"><span class="pre">MinHash.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__eq__"><code class="docutils literal notranslate"><span class="pre">MinHash.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.union"><code class="docutils literal notranslate"><span class="pre">MinHash.union()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__hash__"><code class="docutils literal notranslate"><span class="pre">MinHash.__hash__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHash.__weakref__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.bulk"><code class="docutils literal notranslate"><span class="pre">MinHash.bulk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHash.generator"><code class="docutils literal notranslate"><span class="pre">MinHash.generator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lean-minhash">Lean MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.LeanMinHash"><code class="docutils literal notranslate"><span class="pre">LeanMinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__init__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.update"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.copy"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.bytesize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.bytesize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.serialize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.serialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.deserialize"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.deserialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__getstate__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__getstate__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.__hash__"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.__hash__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.LeanMinHash.union"><code class="docutils literal notranslate"><span class="pre">LeanMinHash.union()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#weighted-minhash">Weighted MinHash</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.__init__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.minhash"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.minhash()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.minhash_many"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.minhash_many()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHashGenerator.__weakref__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHashGenerator.__weakref__</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.WeightedMinHash"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__init__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.jaccard"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.jaccard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.digest"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.copy"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__len__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__eq__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__hash__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__hash__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.WeightedMinHash.__weakref__"><code class="docutils literal notranslate"><span class="pre">WeightedMinHash.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh">MinHash LSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSH"><code class="docutils literal notranslate"><span class="pre">MinHashLSH</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.insert"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.insertion_session"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.insertion_session()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.add_to_query_buffer"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.add_to_query_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.collect_query_buffer"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.collect_query_buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.remove"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.remove()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.get_counts"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.get_counts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.get_subset_counts"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.get_subset_counts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSH.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSH.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asynchronous-minhash-lsh">Asynchronous MinHash LSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh-forest">MinHash LSH Forest</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSHForest"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.add"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.index"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHForest.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHForest.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#minhash-lsh-ensemble">MinHash LSH Ensemble</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__init__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.index"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.query"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__contains__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.is_empty"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.MinHashLSHEnsemble.__weakref__"><code class="docutils literal notranslate"><span class="pre">MinHashLSHEnsemble.__weakref__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hyperloglog">HyperLogLog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.HyperLogLog"><code class="docutils literal notranslate"><span class="pre">HyperLogLog</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__init__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.update"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.count"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.merge"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.digest"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.digest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.copy"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.is_empty"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.is_empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.clear"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__len__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__len__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__eq__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__eq__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__getstate__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__getstate__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLog.__hash__"><code class="docutils literal notranslate"><span class="pre">HyperLogLog.__hash__</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">HyperLogLog++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.__init__"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.__weakref__"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.__weakref__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datasketch.HyperLogLogPlusPlus.count"><code class="docutils literal notranslate"><span class="pre">HyperLogLogPlusPlus.count()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hyperloglog.html">HyperLogLog</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperloglog.html#hyperloglog-plusplus">HyperLogLog++</a></li>
<li class="toctree-l1"><a class="reference internal" href="lsh.html">MinHash LSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="lshensemble.html">MinHash LSH Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="lshforest.html">MinHash LSH Forest</a></li>
<li class="toctree-l1"><a class="reference internal" href="minhash.html">MinHash</a></li>
<li class="toctree-l1"><a class="reference internal" href="weightedminhash.html">Weighted MinHash</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">datasketch: Big Data Looks Small</a></li>
      <li>Next: <a href="hyperloglog.html" title="next chapter">HyperLogLog</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this heading">¶</a></h1>
<section id="minhash">
<h2>MinHash<a class="headerlink" href="#minhash" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHash">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm=128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutations=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash" title="Permalink to this definition">¶</a></dt>
<dd><p>MinHash is a probabilistic data structure for computing
<a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> between sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_perm</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of random permutation functions.
It will be ignored if <cite>hashvalues</cite> is not None.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The random seed controls the set of random
permutation functions generated for this MinHash.</p></li>
<li><p><strong>hashfunc</strong> (<em>optional</em>) – The hash function used by this MinHash.
It takes the input passed to the <cite>update</cite> method and
returns an integer that can be encoded with 32 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
<li><p><strong>hashvalues</strong> (<cite>numpy.array</cite> or <cite>list</cite>, optional) – The hash values is
the internal state of the MinHash. It can be specified for faster
initialization using the existing state from another MinHash.</p></li>
<li><p><strong>permutations</strong> (<em>optional</em>) – The permutation function parameters. This argument
can be specified for faster initialization using the existing
state from another MinHash.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To save memory usage, consider using <a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.LeanMinHash</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 1.1.1, MinHash will only support serialization using
<a class="reference external" href="https://docs.python.org/3/library/pickle.html">pickle</a>. <code class="docutils literal notranslate"><span class="pre">serialize</span></code> and <code class="docutils literal notranslate"><span class="pre">deserialize</span></code> methods are removed,
and are supported in <a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.LeanMinHash</span></code></a> instead.
MinHash serialized before version 1.1.1 cannot be deserialized properly
in newer versions (<a class="reference external" href="https://github.com/ekzhu/datasketch/issues/18">need to migrate?</a>).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 1.1.3, MinHash uses Numpy’s random number generator
instead of Python’s built-in random package. This change makes the
hash values consistent across different Python versions.
The side-effect is that now MinHash created before version 1.1.3 won’t
work (i.e., <code class="docutils literal notranslate"><span class="pre">jaccard</span></code>, <code class="docutils literal notranslate"><span class="pre">merge</span></code> and <code class="docutils literal notranslate"><span class="pre">union</span></code>)
with those created after.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm=128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permutations=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update this MinHash with a new value.
The value will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> – The value to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with a new string value (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">Minhash</span><span class="p">()</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also use a different hash function, for example, <cite>pyfarmhash</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">farmhash</span>
<span class="k">def</span> <span class="nf">_hash_32</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">farmhash</span><span class="o">.</span><span class="n">hash32</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">hashfunc</span><span class="o">=</span><span class="n">_hash_32</span><span class="p">)</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.update_batch">
<span class="sig-name descname"><span class="pre">update_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.update_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.update_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Update this MinHash with new values.
The values will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> (<em>list</em>) – List of values to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with new string values (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">Minhash</span><span class="p">()</span>
<span class="n">minhash</span><span class="o">.</span><span class="n">update_batch</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;token1&quot;</span><span class="p">,</span> <span class="s2">&quot;token2&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.jaccard">
<span class="sig-name descname"><span class="pre">jaccard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.jaccard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.jaccard" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the <a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> (resemblance) between the sets
represented by this MinHash and the other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The other MinHash.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Jaccard similarity, which is between 0.0 and 1.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the cardinality count based on the technique described in
<a class="reference external" href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=365694">this paper</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The estimated cardinality of the set represented by this MinHash.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the other MinHash with this one, making this one the union
of both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The other MinHash.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.digest" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the hash values, which is the internal state of the
MinHash.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The hash values which is a Numpy array.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>If the current MinHash is empty - at the state of just</dt><dd><p>initialized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the current state of the MinHash.
All hash values are reset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.copy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasketch.MinHash – A copy of this MinHash by exporting its state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__len__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>int – The number of hash values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool – If their seeds and hash values are both equal then two are equivalent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.union">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a MinHash which is the union of the MinHash objects passed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*mhs</strong> – The MinHash objects to be united. The argument list length is variable,
but must be at least 2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new union MinHash.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">datasketch.MinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHash.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#datasketch.MinHash.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHash.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHash.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.bulk">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bulk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">minhash_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.bulk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.bulk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MinHashes in bulk. This method avoids unnecessary
overhead when initializing many minhashes by reusing the initialized
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>Iterable</em>) – An Iterable of lists of bytes, each list is
hashed in to one MinHash in the output.</p></li>
<li><p><strong>minhash_kwargs</strong> – Keyword arguments used to initialize MinHash,
will be used for all minhashes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of computed MinHashes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">datasketch.MinHash</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasketch</span> <span class="kn">import</span> <span class="n">MinHash</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="sa">b</span><span class="s1">&#39;token1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token3&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;token4&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token6&#39;</span><span class="p">]]</span>
<span class="n">minhashes</span> <span class="o">=</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">bulk</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHash.generator">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">minhash_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/minhash.html#MinHash.generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHash.generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute MinHashes in a generator. This method avoids unnecessary
overhead when initializing many minhashes by reusing the initialized
state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>Iterable</em>) – An Iterable of lists of bytes, each list is
hashed in to one MinHash in the output.</p></li>
<li><p><strong>minhash_kwargs</strong> – Keyword arguments used to initialize MinHash,
will be used for all minhashes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A generator of computed MinHashes.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasketch</span> <span class="kn">import</span> <span class="n">MinHash</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="sa">b</span><span class="s1">&#39;token1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token3&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;token4&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token5&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;token6&#39;</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">minhash</span> <span class="ow">in</span> <span class="n">MinHash</span><span class="o">.</span><span class="n">generator</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_perm</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
    <span class="c1"># do something useful</span>
    <span class="n">minhash</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="lean-minhash">
<h2>Lean MinHash<a class="headerlink" href="#lean-minhash" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.LeanMinHash">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">LeanMinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash" title="Permalink to this definition">¶</a></dt>
<dd><p>Lean MinHash is MinHash with a smaller memory footprint
and faster deserialization, but with its internal state frozen
– no <cite>update()</cite>.</p>
<p>Lean MinHash inherits all methods from <a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHash</span></code></a>.
It does not store the <cite>permutations</cite> and the <cite>hashfunc</cite> needed for updating.
If a MinHash does not need further updates, convert it into a lean MinHash
to save memory.</p>
<p class="rubric">Example</p>
<p>To create a lean MinHash from an existing MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="p">(</span><span class="n">minhash</span><span class="p">)</span>

<span class="c1"># You can compute the Jaccard similarity between two lean MinHash</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">lean_minhash2</span><span class="p">)</span>

<span class="c1"># Or between a lean MinHash and a MinHash</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">minhash2</span><span class="p">)</span>
</pre></div>
</div>
<p>To create a lean MinHash from the hash values and seed of an existing
MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                           <span class="n">hashvalues</span><span class="o">=</span><span class="n">minhash</span><span class="o">.</span><span class="n">hashvalues</span><span class="p">)</span>
</pre></div>
</div>
<p>To create a MinHash from a lean MinHash:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                  <span class="n">hashvalues</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">hashvalues</span><span class="p">)</span>

<span class="c1"># Or if you want to prevent further updates on minhash</span>
<span class="c1"># from affecting the state of lean_minhash</span>
<span class="n">minhash</span> <span class="o">=</span> <span class="n">MinHash</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                  <span class="n">hashvalues</span><span class="o">=</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lean MinHash can also be used in <a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.MinHashLSH"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSH</span></code></a>,
<a class="reference internal" href="#datasketch.MinHashLSHForest" title="datasketch.MinHashLSHForest"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSHForest</span></code></a>, and <a class="reference internal" href="#datasketch.MinHashLSHEnsemble" title="datasketch.MinHashLSHEnsemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSHEnsemble</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<em>optional</em>) – The <a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHash</span></code></a> object used to
initialize the LeanMinHash. If this is not set, then <cite>seed</cite>
and <cite>hashvalues</cite> must be set.</p></li>
<li><p><strong>seed</strong> (<em>optional</em>) – The random seed that controls the set of random
permutation functions generated for this LeanMinHash. This parameter
must be used together with <cite>hashvalues</cite>.</p></li>
<li><p><strong>hashvalues</strong> (<em>optional</em>) – The hash values used to inititialize the state
of the LeanMinHash. This parameter must be used together with
<cite>seed</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.update" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is not available on a LeanMinHash.
Calling it raises a TypeError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.copy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasketch.MinHash – A copy of this MinHash by exporting its state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.bytesize">
<span class="sig-name descname"><span class="pre">bytesize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.bytesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.bytesize" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the byte size after serialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>byteorder</strong> (<em>str</em><em>, </em><em>optional</em>) – This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Size in number of bytes after serialization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.serialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.serialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize this lean MinHash and store the result in an allocated buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<em>buffer</em>) – <cite>buf</cite> must implement the <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">buffer</a> interface.
One such example is the built-in <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> class.</p></li>
<li><p><strong>byteorder</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</p></li>
</ul>
</dd>
</dl>
<p>This is preferred over using <a class="reference external" href="https://docs.python.org/3/library/pickle.html">pickle</a> if the serialized lean MinHash needs
to be used by another program in a different programming language.</p>
<dl class="simple">
<dt>The serialization schema:</dt><dd><ol class="arabic simple">
<li><p>The first 8 bytes is the seed integer</p></li>
<li><p>The next 4 bytes is the number of hash values</p></li>
<li><p>The rest is the serialized hash values, each uses 4 bytes</p></li>
</ol>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To serialize a single lean MinHash into a <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">lean_minhash</span><span class="o">.</span><span class="n">bytesize</span><span class="p">())</span>
<span class="n">lean_minhash</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</pre></div>
</div>
<p>To serialize multiple lean MinHash into a <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># assuming lean_minhashs is a list of LeanMinHash with the same size</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">lean_minhashs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bytesize</span><span class="p">()</span>
<span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">lean_minhashs</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lean_minhash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lean_minhashs</span><span class="p">):</span>
    <span class="n">lean_minhash</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">size</span><span class="p">:])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.deserialize">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">byteorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&#64;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.deserialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.deserialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize a lean MinHash from a buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<em>buffer</em>) – <cite>buf</cite> must implement the <a class="reference external" href="https://docs.python.org/3/c-api/buffer.html">buffer</a> interface.
One such example is the built-in <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bytearray">bytearray</a> class.</p></li>
<li><p><strong>byteorder</strong> (<em>str. optional</em>) – <p>This is byte order of the serialized data. Use one
of the <a class="reference external" href="https://docs.python.org/3/library/struct.html#byte-order-size-and-alignment">byte order characters</a>:
<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">!</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> – the native order.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deserialized lean MinHash</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.LeanMinHash" title="datasketch.LeanMinHash">datasketch.LeanMinHash</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To deserialize a lean MinHash from a buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lean_minhash</span> <span class="o">=</span> <span class="n">LeanMinHash</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__getstate__">
<span class="sig-name descname"><span class="pre">__getstate__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__getstate__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for pickle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.__hash__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.__hash__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return hash(self).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.LeanMinHash.union">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">lmhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lean_minhash.html#LeanMinHash.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.LeanMinHash.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a MinHash which is the union of the MinHash objects passed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*mhs</strong> – The MinHash objects to be united. The argument list length is variable,
but must be at least 2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new union MinHash.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash">datasketch.MinHash</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="weighted-minhash">
<h2>Weighted MinHash<a class="headerlink" href="#weighted-minhash" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">WeightedMinHashGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>The weighted MinHash generator is used for creating
new <a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.WeightedMinHash</span></code></a> objects.</p>
<p>This weighted MinHash implementation is based on Sergey Ioffe’s paper,
<a class="reference external" href="http://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36928.pdf">Improved Consistent Sampling, Weighted Minhash and L1 Sketching</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – The number of dimensions of the input Jaccard vectors.</p></li>
<li><p><strong>sample_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of samples to use for creating
weighted MinHash.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – The random seed to use for generating permutation functions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.minhash">
<span class="sig-name descname"><span class="pre">minhash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.minhash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.minhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new weighted MinHash given a weighted Jaccard vector.
Each dimension is an integer
frequency of the corresponding element in the multi-set represented
by the vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<em>numpy.array</em>) – The Jaccard vector.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.minhash_many">
<span class="sig-name descname"><span class="pre">minhash_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">spmatrix</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.weighted_minhash.WeightedMinHash"><span class="pre">WeightedMinHash</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHashGenerator.minhash_many"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.minhash_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new WeightedMinHash instances given a matrix of weighted
Jaccard vectors.  In the input matrix X, each row corresponds to a
multi-set, and each column stores the integer frequency of the
element of a dimension.</p>
<dl class="simple">
<dt>Note: this method is experimental and does not yield the same MinHash</dt><dd><p>hash values as <cite>minhash</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>Union</em><em>[</em><em>sp.sparse.spmatrix</em><em>, </em><em>np.ndarray</em><em>]</em>) – A matrix of Jaccard
vectors (rows).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Union[WeightedMinHash, None]] - A list of length X.shape[0].
Each element is either a WeightedMinHash instance or None
(if the original row in X is empty).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.WeightedMinHashGenerator.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.WeightedMinHashGenerator.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">WeightedMinHash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash" title="Permalink to this definition">¶</a></dt>
<dd><p>New weighted MinHash is generated by
<a class="reference internal" href="#datasketch.WeightedMinHashGenerator" title="datasketch.WeightedMinHashGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.WeightedMinHashGenerator</span></code></a>.
You can also initialize weighted MinHash by using the state
from an existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – The random seed used to generate this weighted
MinHash.</p></li>
<li><p><strong>hashvalues</strong> – The internal state of this weighted MinHash.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashvalues</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.jaccard">
<span class="sig-name descname"><span class="pre">jaccard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.jaccard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.jaccard" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the <a class="reference external" href="http://mathoverflow.net/questions/123339/weighted-jaccard-similarity">weighted Jaccard similarity</a> between the
multi-sets represented by this weighted MinHash and the other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash"><em>datasketch.WeightedMinHash</em></a>) – The other weighted MinHash.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The weighted Jaccard similarity between 0.0 and 1.0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.digest" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the hash values, which is the internal state of the
weighted MinHash.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The hash values which is a Numpy array.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.copy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of this weighted MinHash by exporting
its state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#datasketch.WeightedMinHash" title="datasketch.WeightedMinHash">datasketch.WeightedMinHash</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__len__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of hash values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/weighted_minhash.html#WeightedMinHash.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.WeightedMinHash.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If their seeds and hash values are both equal then two
are equivalent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#datasketch.WeightedMinHash.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.WeightedMinHash.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.WeightedMinHash.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</section>
<section id="minhash-lsh">
<h2>MinHash LSH<a class="headerlink" href="#minhash-lsh" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="lsh.html#minhash-lsh"><span class="std std-ref">MinHash LSH</span></a> index.
It supports query with <a class="reference external" href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard similarity</a> threshold.
Reference: <a class="reference external" href="http://www.mmds.org/">Chapter 3, Mining of Massive Datasets</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>float</em>) – The Jaccard similarity threshold between 0.0 and
1.0. The initialized MinHash LSH will be optimized for the threshold by
minizing the false positive and false negative.</p></li>
<li><p><strong>num_perm</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>weights</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Used to adjust the relative importance of
minimizing false positive and false negative when optimizing
for the Jaccard similarity threshold.
<cite>weights</cite> is a tuple in the format of
<code class="code docutils literal notranslate"><span class="pre">(false_positive_weight,</span> <span class="pre">false_negative_weight)</span></code>.</p></li>
<li><p><strong>params</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The LSH parameters (i.e., number of bands and size
of each bands). This is used to bypass the parameter optimization
step in the constructor. <cite>threshold</cite> and <cite>weights</cite> will be ignored
if this is given.</p></li>
<li><p><strong>storage_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Type of storage service to use for storing
hashtables and keys.
<cite>basename</cite> is an optional property whose value will be used as the prefix to
stored keys. If this is not set, a random string will be generated instead. If you
set this, you will be responsible for ensuring there are no key collisions.</p></li>
<li><p><strong>prepickle</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, all keys are pickled to bytes before
insertion. If None, a default value is chosen based on the
<cite>storage_config</cite>.</p></li>
<li><p><strong>hashfunc</strong> (<em>function</em><em>, </em><em>optional</em>) – If a hash function is provided it will be used to
compress the index keys to reduce the memory footprint. This could cause a higher
false positive rate.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>weights</cite> must sum to 1.0, and the format is
(false positive weight, false negative weight).
For example, if minimizing false negative (or maintaining high recall) is more
important, assign more weight toward false negative: weights=(0.4, 0.6).
Try to live with a small difference between weights (i.e. &lt; 0.5).</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_duplication</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a key to the index, together
with a MinHash (or weighted MinHash) of the set referenced by
the key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The identifier of the set.</p></li>
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the set.</p></li>
<li><p><strong>check_duplication</strong> (<em>bool</em>) – To avoid duplicate keys in the storage (<cite>default=True</cite>).
It’s recommended to not change the default, but
if you want to avoid the overhead during insert
you can set <cite>check_duplication = False</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.insertion_session">
<span class="sig-name descname"><span class="pre">insertion_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.insertion_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.insertion_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a context manager for fast insertion into this index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer_size</strong> (<em>int</em>) – The buffer size for insert_session mode (default=50000).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>datasketch.lsh.MinHashLSHInsertionSession</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Giving the MinHash of the query set, retrieve
the keys that references sets with Jaccard
similarities greater than the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the query set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>list</cite> of unique keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.add_to_query_buffer">
<span class="sig-name descname"><span class="pre">add_to_query_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.add_to_query_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.add_to_query_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Giving the MinHash of the query set, buffer
queries to retrieve the keys that references
sets with Jaccard similarities greater than
the threshold.</p>
<p>Buffered queries can be executed using
<cite>collect_query_buffer</cite>. The combination of these
functions is way faster if cassandra backend
is used with <cite>shared_buffer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the query set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.collect_query_buffer">
<span class="sig-name descname"><span class="pre">collect_query_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.collect_query_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.collect_query_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute and return buffered queries given
by <cite>add_to_query_buffer</cite>.</p>
<p>If multiple query MinHash were added to the query buffer,
the intersection of the results of all query MinHash will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list</cite> of unique keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>hashable</em>) – The unique identifier of a set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True only if the key exists in the index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the key from the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>hashable</em>) – The unique identifier of a set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Check if the index is empty.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.get_counts">
<span class="sig-name descname"><span class="pre">get_counts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.get_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.get_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of length <code class="docutils literal notranslate"><span class="pre">self.b</span></code> with elements representing the
number of keys stored under each bucket for the given permutation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.get_subset_counts">
<span class="sig-name descname"><span class="pre">get_subset_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lsh.html#MinHashLSH.get_subset_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSH.get_subset_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bucket allocation counts (see <a class="reference internal" href="#datasketch.MinHashLSH.get_counts" title="datasketch.MinHashLSH.get_counts"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_counts()</span></code></a> above)
restricted to the list of keys given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>hashable</em>) – the keys for which to get the bucket allocation
counts</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSH.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSH.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</section>
<section id="asynchronous-minhash-lsh">
<h2>Asynchronous MinHash LSH<a class="headerlink" href="#asynchronous-minhash-lsh" title="Permalink to this heading">¶</a></h2>
</section>
<section id="minhash-lsh-forest">
<h2>MinHash LSH Forest<a class="headerlink" href="#minhash-lsh-forest" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSHForest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest" title="Permalink to this definition">¶</a></dt>
<dd><p>The LSH Forest for MinHash. It supports top-k query in Jaccard
similarity.
Instead of using prefix trees as the <a class="reference external" href="http://ilpubs.stanford.edu:8090/678/1/2005-14.pdf">original paper</a>,
I use a sorted array to store the hash values in every
hash table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_perm</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>l</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of prefix trees as described in the
paper.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MinHash LSH Forest also works with weighted Jaccard similarity
and weighted MinHash without modification.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a unique key, together
with a MinHash (or weighted MinHash) of the set referenced by the key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The key won’t be searchbale until the
<a class="reference internal" href="#datasketch.MinHashLSHForest.index" title="datasketch.MinHashLSHForest.index"><code class="xref py py-func docutils literal notranslate"><span class="pre">datasketch.MinHashLSHForest.index()</span></code></a> method is called.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>hashable</em>) – The unique identifier of the set.</p></li>
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Index all the keys added so far and make them searchable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the approximate top-k keys that have the
(approximately) highest Jaccard similarities to the query set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the query set.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The maximum number of keys to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>list</cite> of at most k keys.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tip for improving accuracy:
you can use a multiple of <cite>k</cite> (e.g., <cite>2*k</cite>) in the argument,
compute the exact (or approximate using MinHash) Jaccard
similarities of the sets referenced by the returned keys,
from which you then take the final top-k. This is often called
“post-processing”. Because the total number of similarity
computations is still bounded by a constant multiple of <cite>k</cite>, the
performance won’t degrade too much – however you do have to keep
the original sets (or MinHashes) around some where so that you
can make references to them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether there is any searchable keys in the index.
Note that keys won’t be searchable until <cite>index</cite> is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if there is no searchable key in the index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshforest.html#MinHashLSHForest.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHForest.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True only if the key has been added to the index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSHForest.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSHForest.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</section>
<section id="minhash-lsh-ensemble">
<h2>MinHash LSH Ensemble<a class="headerlink" href="#minhash-lsh-ensemble" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">MinHashLSHEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_part</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="lshensemble.html#minhash-lsh-ensemble"><span class="std std-ref">MinHash LSH Ensemble</span></a> index. It supports
<a class="reference internal" href="lshensemble.html#containment"><span class="std std-ref">Containment</span></a> queries.
The implementation is based on
<a class="reference external" href="http://www.vldb.org/pvldb/vol9/p1185-zhu.pdf">E. Zhu et al.</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>float</em>) – The Containment threshold between 0.0 and
1.0. The initialized LSH Ensemble will be optimized for the threshold by
minizing the false positive and false negative.</p></li>
<li><p><strong>num_perm</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of permutation functions used
by the MinHash to be indexed. For weighted MinHash, this
is the sample size (<cite>sample_size</cite>).</p></li>
<li><p><strong>num_part</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of partitions in LSH Ensemble.</p></li>
<li><p><strong>m</strong> (<em>int</em><em>, </em><em>optional</em>) – The memory usage factor: an LSH Ensemble uses approximately
<cite>m</cite> times more memory space than a MinHash LSH with the same number of
sets indexed. The higher the <cite>m</cite> the better the accuracy.</p></li>
<li><p><strong>weights</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Used to adjust the relative importance of
minizing false positive and false negative when optimizing
for the Containment threshold. Similar to the <cite>weights</cite> parameter
in <a class="reference internal" href="#datasketch.MinHashLSH" title="datasketch.MinHashLSH"><code class="xref py py-class docutils literal notranslate"><span class="pre">datasketch.MinHashLSH</span></code></a>.</p></li>
<li><p><strong>storage_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Type of storage service to use for storing
hashtables and keys.
<cite>basename</cite> is an optional property whose value will be used as the prefix to
stored keys. If this is not set, a random string will be generated instead. If you
set this, you will be responsible for ensuring there are no key collisions.</p></li>
<li><p><strong>prepickle</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, all keys are pickled to bytes before
insertion. If None, a default value is chosen based on the
<cite>storage_config</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using more partitions (<cite>num_part</cite>) leads to better accuracy, at the
expense of slower query performance.
This is different from <a class="reference external" href="http://www.vldb.org/pvldb/vol9/p1185-zhu.pdf">the paper</a> and the <a class="reference external" href="https://github.com/ekzhu/lshensemble">Go implementation</a>, in which
more partitions leads to better accuracy AND faster query performance,
due to parallelism.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>More information about the parameter <cite>m</cite> can be found in the
<a class="reference external" href="https://github.com/ekzhu/lshensemble">Go implementation</a>
of LSH Ensemble, in which <cite>m</cite> is named <cite>MaxK</cite>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_part</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepickle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entries</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Index all sets given their keys, MinHashes, and sizes.
It can be called only once after the index is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>entries</strong> (<cite>iterable</cite> of <cite>tuple</cite>) – An iterable of tuples, each must be
in the form of <cite>(key, minhash, size)</cite>, where <cite>key</cite> is the unique
identifier of a set, <cite>minhash</cite> is the MinHash of the set,
and <cite>size</cite> is the size or number of unique items in the set.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>size</cite> must be positive.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minhash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Giving the MinHash and size of the query set, retrieve
keys that references sets with containment with respect to
the query set greater than the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minhash</strong> (<a class="reference internal" href="#datasketch.MinHash" title="datasketch.MinHash"><em>datasketch.MinHash</em></a>) – The MinHash of the query set.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – The size (number of unique items) of the query set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>iterator</cite> of keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>hashable</em>) – The unique identifier of a set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True only if the key exists in the index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/lshensemble.html#MinHashLSHEnsemble.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Check if the index is empty.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.MinHashLSHEnsemble.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.MinHashLSHEnsemble.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</section>
<section id="hyperloglog">
<h2>HyperLogLog<a class="headerlink" href="#hyperloglog" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.HyperLogLog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">HyperLogLog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog" title="Permalink to this definition">¶</a></dt>
<dd><p>The HyperLogLog data sketch for estimating
cardinality of very large dataset in a single pass.
The original HyperLogLog is described <a class="reference external" href="http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf">here</a>.</p>
<p>This HyperLogLog implementation is based on:
<a class="reference external" href="https://github.com/svpcom/hyperloglog">https://github.com/svpcom/hyperloglog</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>int</em><em>, </em><em>optional</em>) – The precision parameter. It is ignored if
the <cite>reg</cite> is given.</p></li>
<li><p><strong>reg</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – The internal state.
This argument is for initializing the HyperLogLog from
an existing one.</p></li>
<li><p><strong>hashfunc</strong> (<em>optional</em>) – The hash function used by this MinHash.
It takes the input passed to the <cite>update</cite> method and
returns an integer that can be encoded with 32 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash32&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the HyperLogLog with a new data value in bytes.
The value will be hashed using the hash function specified by
the <cite>hashfunc</cite> argument in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>b</strong> – The value to be hashed using the hash function specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To update with a new string value (using the default SHA1 hash
function, which requires bytes as input):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hll</span> <span class="o">=</span> <span class="n">HyperLogLog</span><span class="p">()</span>
<span class="n">hll</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also use a different hash function, for example, <cite>pyfarmhash</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">farmhash</span>
<span class="k">def</span> <span class="nf">_hash_32</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">farmhash</span><span class="o">.</span><span class="n">hash32</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">hll</span> <span class="o">=</span> <span class="n">HyperLogLog</span><span class="p">(</span><span class="n">hashfunc</span><span class="o">=</span><span class="n">_hash_32</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;new value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the cardinality of the data values seen so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The estimated cardinality.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the other HyperLogLog with this one, making this the union of the
two.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog"><em>datasketch.HyperLogLog</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.digest">
<span class="sig-name descname"><span class="pre">digest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.digest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.digest" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current internal state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a copy of the current HyperLogLog by exporting its state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog">datasketch.HyperLogLog</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current HyperLogLog is empty - at the state of just
initialized.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the current HyperLogLog to empty.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__len__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Get the size of the HyperLogLog as the size of</dt><dd><p><cite>reg</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__eq__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Check equivalence between two HyperLogLogs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#datasketch.HyperLogLog" title="datasketch.HyperLogLog"><em>datasketch.HyperLogLog</em></a>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if both have the same internal state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__getstate__">
<span class="sig-name descname"><span class="pre">__getstate__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLog.__getstate__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLog.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for pickle.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.HyperLogLog.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#datasketch.HyperLogLog.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="id3">
<h2>HyperLogLog++<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasketch.</span></span><span class="sig-name descname"><span class="pre">HyperLogLogPlusPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash64&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus" title="Permalink to this definition">¶</a></dt>
<dd><p>HyperLogLog++ is an enhanced HyperLogLog <a class="reference external" href="http://research.google.com/pubs/pub40671.html">from Google</a>.
Main changes from the original HyperLogLog:</p>
<ol class="arabic simple">
<li><p>Use 64 bits instead of 32 bits for hash function</p></li>
<li><p>A new small-cardinality estimation scheme</p></li>
<li><p>Sparse representation (not implemented here)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>int</em><em>, </em><em>optional</em>) – The precision parameter. It is ignored if
the <cite>reg</cite> is given.</p></li>
<li><p><strong>reg</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – The internal state.
This argument is for initializing the HyperLogLog from
an existing one.</p></li>
<li><p><strong>hashfunc</strong> (<em>optional</em>) – The hash function used by this MinHash.
It takes the input passed to the <cite>update</cite> method and
returns an integer that can be encoded with 64 bits.
The default hash function is based on SHA1 from <a class="reference external" href="https://docs.python.org/3.5/library/hashlib.html">hashlib</a>.</p></li>
<li><p><strong>hashobj</strong> (<strong>deprecated</strong>) – This argument is deprecated since version
1.4.0. It is a no-op and has been replaced by <cite>hashfunc</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashfunc=&lt;function</span> <span class="pre">sha1_hash64&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashobj=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasketch.HyperLogLogPlusPlus.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasketch/hyperloglog.html#HyperLogLogPlusPlus.count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasketch.HyperLogLogPlusPlus.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the cardinality of the data values seen so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The estimated cardinality.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, Eric Zhu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/documentation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-93507731-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>